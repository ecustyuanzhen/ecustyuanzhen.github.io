---
title: 设计模式-代理模式
date: 2020-12-18 23:55:52
tags:
---

### 是什么

为其他对象提供一种代理以控制对这个对象的访问。



代理模式，即Proxy，它和Adapter模式很类似。Adapter模式:它用于把A接口转换为B接口：

```java
public BAdapter implements B {
    private A a;
    public BAdapter(A a) {
        this.a = a;
    }
    public void b() {
        a.a();
    }
}
```

而Proxy模式不是把A接口转换成B接口，它还是转换成A接口：

```java
public AProxy implements A {
    private A a;
    public AProxy(A a) {
        this.a = a;
    }
    public void a() {
        this.a.a();
    }
}
```

### 好处

* 隐藏委托类的具体实现。

* 实现客户与委托类的解耦，在不改变委托类代码的情况下添加一些额外的功能（日志、权限）等。

### 分类

#### 静态代理

静态代理是指代理类在程序运行前就已经存在，这种情况下的代理类通常都是我们在Java代码中定义的

**缺点**：

当需要代理多个类时，代理对象要实现与目标对象一致的接口。要么，只维护一个代理类来实现多个接口，但这样会导致代理类过于庞大。要么，新建多个代理类，但这样会产生过多的代理类。

#### 动态代理

动态代理是指代理类在程序运行时进行创建的代理方式。jdk动态代理、CGLIB动态代理。

* Jdk动态代理生成的代理类默认继承proxy类，由于Java不支持多重继承，故被代理的类需要实现某接口，代理类实现对应接口，暴露对应方法。
* cglib是一个强大的高性能代码生成库，它的底层是通过使用一个小而快的字节码处理框架ASM（Java字节码操控框架）来转换字节码并生成新的类。cglib要求被代理对象未被final修饰

